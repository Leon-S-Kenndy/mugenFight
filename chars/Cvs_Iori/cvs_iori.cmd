;=====================================================================
;  CMD File For "iori"	                                Made By H"        
;=====================================================================

;=====================================================================
; Definition of the Commands
;=====================================================================
;-| Button Remapping |-----------------------------------------------------
[Remap]
x = x
y = y
z = z
a = a
b = b
c = c
s = s

;-| Default Values |-------------------------------------------------------
[Defaults]
command.time = 15

command.buffer.time = 0

;-| AI |------------------------------------------------------
[Command]
name = "CPU1"
command = U, D, F
time = 1

[Command]
name = "CPU2"
command = U, B, F
time = 1

[Command]
name = "CPU3"
command = U, D, D
time = 1

[Command]
name = "CPU4"
command = F, B, U
time = 1

[Command]
name = "CPU5"
command = U, F, U, B
time = 1

[Command]
name = "CPU6"
command = U, D, B
time = 1

[Command]
name = "CPU7"
command = F, F, B
time = 1

[Command]
name = "CPU8"
command = U, D, U
time = 1

[Command]
name = "CPU9"
command = F, B, B
time = 1

[Command]
name = "CPU10"
command = F, F, B, B
time = 1

[Command]
name = "CPU11"
command = U, U, F
time = 1

[Command]
name = "CPU12"
command = U, B, B
time = 1

[Command]
name = "CPU13"
command = U, B, F, F
time = 1

[Command]
name = "CPU14"
command = U, F, B, U
time = 1

[Command]
name = "CPU15"
command = U, B, F, U
time = 1

[Command]
name = "CPU16"
command = U, B, B, B
time = 1

[Command]
name = "CPU17"
command = U, D, B, F
time = 1

[Command]
name = "CPU18"
command = U, D, B, D
time = 1

[Command]
name = "CPU19"
command = U, D, F, U
time = 1

[Command]
name = "CPU20"
command = U, D, U, B
time = 1

[Command]
name = "CPU21"
command = U, D, F, F
time = 1

[Command]
name = "CPU22"
command = F, F, F, F
time = 1

[Command]
name = "CPU23"
command = U, U, U, D
time = 1

[Command]
name = "CPU24"
command = B, B, B
time = 1

[Command]
name = "CPU25"
command = D, D, D, D
time = 1

[Command]
name = "CPU26"
command = D, D, D
time = 1

[Command]
name = "CPU27"
command = F, F, F
time = 1

[Command]
name = "CPU28"
command = U, U, U
time = 1

[Command]
name = "CPU29"
command = U, U, B, B
time = 1

[Command]
name = "CPU30"
command = D, D, F, F
time = 1

[Command]
name = "CPU31"
command = U, D, F, U, D
time = 1

[Command]
name = "CPU32"
command = U, B, F, U, D
time = 1

[Command]
name = "CPU33"
command = U, D, D, U, D
time = 1

[Command]
name = "CPU34"
command = F, B, U, U, D
time = 1

[Command]
name = "CPU35"
command = U, F, U, B, U, D
time = 1

[Command]
name = "CPU36"
command = U, D, B, U, D
time = 1

[Command]
name = "CPU37"
command = F, F, B, U, D
time = 1

[Command]
name = "CPU38"
command = U, D, U, U, D
time = 1

[Command]
name = "CPU39"
command = F, B, B, U, D
time = 1

[Command]
name = "CPU40"
command = F, F, B, B, U, D
time = 1

[Command]
name = "CPU41"
command = U, U, F, U, D
time = 1

[Command]
name = "CPU42"
command = U, B, B, U, D
time = 1

[Command]
name = "CPU43"
command = U, B, F, F, U, D
time = 1

[Command]
name = "CPU44"
command = U, F, B, U, U, D
time = 1

[Command]
name = "CPU45"
command = U, B, F, U, U, D
time = 1

[Command]
name = "CPU46"
command = U, B, B, B, U, D
time = 1

[Command]
name = "CPU47"
command = U, D, B, F, U, D
time = 1

[Command]
name = "CPU48"
command = U, D, B, D, U, D
time = 1

[Command]
name = "CPU49"
command = U, D, F, U, U, D
time = 1

[Command]
name = "CPU50"
command = U, D, U, B, U, D
time = 1

;-| Super Motions |---------------------------------------------------
[Command]
name = "Ura 108 Shiki: Ya Sakazuki_LV.3"
command = ~D, B, D, F, z
time = 26

[Command]
name = "Ura 108 Shiki: Ya Sakazuki_LV.2"
command = ~D, B, D, F, y
time = 26

[Command]
name = "Ura 108 Shiki: Ya Sakazuki_LV.1"
command = ~D, B, D, F, x
time = 26

[Command]
name = "Kin 1211 Shiki: Ya Otome_LV.3"
command = ~D, F, D, B, z
time = 26

[Command]
name = "Kin 1211 Shiki: Ya Otome_LV.2"
command = ~D, F, D, B, y
time = 26

[Command]
name = "Kin 1211 Shiki: Ya Otome_LV.1"
command = ~D, F, D, B, x
time = 26

[Command]
name = "Ura 100 Shiki: Oni homura_LV.3"
command = ~D, F, D, F, z
time = 26

[Command]
name = "Ura 100 Shiki: Oni homura_LV.2"
command = ~D, F, D, F, y
time = 26

[Command]
name = "Ura 100 Shiki: Oni homura_LV.1"
command = ~D, F, D, F, x
time = 26

[Command]
name = "Overdrive"
command = ~F, D, B, s
time = 20

;-| Special Motions |---------------------------------------------------
;
[Command]
name = "Kuzukaze"
command = ~F, D, B, F, x
time = 20

[Command]
name = "Kuzukaze"
command = ~F, D, B, F, y
time = 20

[Command]
name = "Kuzukaze"
command = ~F, D, B, F, z
time = 20

[Command]
name = "212 Shiki: Kototsuki In_a"
command = ~F, DF, D, DB, B, a
time = 20

[Command]
name = "212 Shiki: Kototsuki In_b"
command = ~F, DF, D, DB, B, b
time = 20

[Command]
name = "212 Shiki: Kototsuki In_c"
command = ~F, DF, D, DB, B, c
time = 20

[Command]
name = "100 Shiki: Oniyaki_x"
command = ~F, D, DF, x

[Command]
name = "100 Shiki: Oniyaki_y"
command = ~F, D, DF, y

[Command]
name = "100 Shiki: Oniyaki_z"
command = ~F, D, DF, z

[Command]
name = "108 Shiki: Yami Barai_x"
command = ~D, DF, F, x

[Command]
name = "108 Shiki: Yami Barai_y"
command = ~D, DF, F, y

[Command]
name = "108 Shiki: Yami Barai_z"
command = ~D, DF, F, z

[Command]
name = "127 Shiki: Aoi Hana"
command = ~D, DB, B, x

[Command]
name = "127 Shiki: Aoi Hana"
command = ~D, DB, B, y

[Command]
name = "127 Shiki: Aoi Hana"
command = ~D, DB, B, z

;-| Double Tap |------------------------------------------------------
[Command]
name = "FF";Required (do not remove)
command = F, F
time = 10

[Command]
name = "BB";Required (do not remove)
command = B, B
time = 10

;-| 2/3 Button Combination |------------------------------------------
[Command]
name = "recovery_ground"
command = x+y+z
time = 1

[Command]
name = "Pow-MAX"
command = z+c
time = 1

[Command]
name = "recovery";Required (do not remove)
command = a+x
time = 1

;-| Dir + Button |----------------------------------------------------
[Command]
name = "GC_Attack"
command = /F,y+b
time = 1

[Command]
name = "GC_fwd"
command = /F,x+a
time = 1

[Command]
name = "GC_back"
command = /B,x+a
time = 1

[Command]
name = "fwd_b"
command = /F,b
time = 1

[Command]
name = "fwd_y"
command = /F,y
time = 1

[Command]
name = "back_a"
command = /B,a
time = 1

[Command]
name = "fwd_c"
command = /F,c
time = 1

[Command]
name = "fwd_z"
command = /F,z
time = 1

[Command]
name = "back_c"
command = /B,c
time = 1

[Command]
name = "back_z"
command = /B,z
time = 1

[Command]
name = "down_y"
command = /D,y
time = 1

[Command]
name = "down_z"
command = /D,z
time = 1

[Command]
name = "charge1"
command = /c
time = 1

[Command]
name = "charge2"
command = /z
time = 1

;-| Single Button |---------------------------------------------------
[Command]
name = "x"
command = x
time = 1

[Command]
name = "a"
command = a
time = 1

[Command]
name = "y"
command = y
time = 1

[Command]
name = "b"
command = b
time = 1

[Command]
name = "c"
command = c
time = 1

[Command]
name = "z"
command = z
time = 1

[Command]
name = "s"
command = s
time = 1

;----------------------------- 方向
[Command]
name = "fwd"
command = F
time = 1

[Command]
name = "downfwd"
command = DF
time = 1

[Command]
name = "down"
command = D
time = 1

[Command]
name = "downback"
command = DB
time = 1

[Command]
name = "back"
command = B
time = 1

[Command]
name = "upback"
command = UB
time = 1

[Command]
name = "up"
command = U
time = 1

[Command]
name = "upfwd"
command = UF
time = 1

[Command]
name = "Not-Neutral"
command = $U
time = 1

[Command]
name = "Not-Neutral"
command = $F
time = 1

[Command]
name = "Not-Neutral"
command = $D
time = 1

[Command]
name = "Not-Neutral"
command = $B
time = 1

;----------------------------- レバガチャ
[Command]
name = "random"
command = x
time = 1

[Command]
name = "random"
command = y
time = 1

[Command]
name = "random"
command = z
time = 1

[Command]
name = "random"
command = a
time = 1

[Command]
name = "random"
command = b
time = 1

[Command]
name = "random"
command = c
time = 1

[Command]
name = "random"
command = F
time = 1

[Command]
name = "random"
command = DF
time = 1

[Command]
name = "random"
command = D
time = 1

[Command]
name = "random"
command = DB
time = 1

[Command]
name = "random"
command = B
time = 1

[Command]
name = "random"
command = UB
time = 1

[Command]
name = "random"
command = U
time = 1

[Command]
name = "random"
command = UF
time = 1

;-| Hold Button |-----------------------------------------------------
[Command]
name = "hold_x"
command = /x
time = 1

[Command]
name = "hold_a"
command = /a
time = 1

[Command]
name = "hold_y"
command = /y
time = 1

[Command]
name = "hold_b"
command = /b
time = 1

[Command]
name = "hold_c"
command = /c
time = 1

[Command]
name = "hold_z"
command = /z
time = 1

[Command]
name = "hold_s"
command = /s
time = 1

;-| Hold Dir |--------------------------------------------------------
[Command]
name = "holdfwd";Required (do not remove)
command = /$F
time = 1

[Command]
name = "holdback";Required (do not remove)
command = /$B
time = 1

[Command]
name = "holdup";Required (do not remove)
command = /$U
time = 1

[Command]
name = "holddown";Required (do not remove)
command = /$D
time = 1

[Command]
name = "holdupfwd"
command = /UF
time = 1

[Command]
name = "holdupback"
command = /UB
time = 1


;=====================================================================
; State Entry for Commands
;=====================================================================

[Statedef -1]
;=====================================================================
; キャンセル設定
;=====================================================================
;------------------------ キャンセル設定リセット
[State -1]
type = varset
trigger1 = var(22)
var(22) = 0
;------------------------ オリジナルコンボ
[State -1]
type = varset
triggerall = RoundState = 2
triggerall = !var(22)
trigger1  = StateNo = 1405 && AnimElem = 4,> 0
trigger2  = (ProjContactTime(1000) = [1,35]) && (StateNo = 1000 || StateNo = 1010 || StateNo = 1020)
trigger3  = MoveContact && (StateNo = 1101 || StateNo = 1300 || StateNo = 1301 || StateNo = 1303)
var(22) = 4
ignorehitpause = 1
;------------------------ Lv.2スパコンキャンセル
[State -1]
type = varset
triggerall = RoundState = 2
triggerall = !var(22)
triggerall = Var(30) = 1
trigger1  = StateNo = 3110 && MoveHit
trigger2  = StateNo = 3101 && PrevStateNo = 3110
trigger3  = StateNo = 3115 && (AnimElem = 6,<0 || AnimElem = 16,> 0)
trigger4  = StateNo = 3310 && MoveHit
var(22) = -1
ignorehitpause = 1
;------------------------ ダッシュキャンセル
[State -1]
type = varset
triggerall = RoundState = 2
trigger1 = !var(22)
trigger1 = StateNo = 100
var(22) = 1
;------------------------ 前転キャンセル
[State -1]
type = varset
triggerall = RoundState = 2
triggerall = !var(22)
trigger1  = StateNo = 4000 && AnimElem = 2,< 1
var(22) = 2
ignorehitpause = 1
;------------------------ 必殺技キャンセル
[State -1]
type = varset
triggerall = RoundState = 2
triggerall = !var(22)
triggerall = MoveContact
trigger1  = (StateNo = 200 && AnimElem = 2,> 1) || (StateNo = 205 && AnimElem = 2,> 1) || StateNo = 210 || StateNo = 215
trigger2  = StateNo = 235 || (StateNo = 220 && AnimElemNo(0) < 5) || ((StateNo = 225 || StateNo = 4020) && var(12))
trigger3  = (StateNo = 400 && AnimElem = 2,> 1) || StateNo = 410 || StateNo = 420 || (StateNo = 430 && AnimElem = 2,> 1)
trigger4  = StateNo = 720
trigger5  = StateNo = 4000 && Time < 5
trigger6  = StateNo = 52 
var(22) = 2
ignorehitpause = 1
;------------------------ SC・超必キャンセル
[State -1]
type = varset
triggerall = RoundState = 2
triggerall = !var(22)
triggerall  = MoveContact
trigger1  = ((StateNo = 225 || StateNo = 4020) && var(12)) || StateNo = 230 || StateNo = 240 || StateNo = 245 || StateNo = 255
trigger2  = StateNo = 440
var(22) = 3
ignorehitpause = 1

;------------------------ オリジナルコンボ
[State -1]
type = varset
triggerall = RoundState = 2
triggerall = !var(22)
triggerall  = StateType != A
trigger1  = StateNo = [200,799]
var(22) = 5
ignorehitpause = 1

;=====================================================================
; CPU Function
;=====================================================================
;---------------------------------------------------------------------
;AI
[State -1, AI]
type = VarSet
triggerall= var(38) != 1
triggerall= RoundState != 3
trigger1  = command = "CPU1"
trigger2  = command = "CPU2"
trigger3  = command = "CPU3"
trigger4  = command = "CPU4"
trigger5  = command = "CPU5"
trigger6  = command = "CPU6"
trigger7  = command = "CPU7"
trigger8  = command = "CPU8"
trigger9  = command = "CPU9"
trigger10  = command = "CPU10"
trigger11  = command = "CPU11"
trigger12  = command = "CPU12"
trigger13  = command = "CPU13"
trigger14  = command = "CPU14"
trigger15  = command = "CPU15"
trigger16  = command = "CPU16"
trigger17  = command = "CPU17"
trigger18  = command = "CPU18"
trigger19  = command = "CPU19"
trigger20  = command = "CPU20"
trigger21  = command = "CPU21"
trigger22  = command = "CPU22"
trigger23  = command = "CPU23"
trigger24  = command = "CPU24"
trigger25  = command = "CPU25"
trigger26  = command = "CPU26"
trigger27  = command = "CPU27"
trigger28  = command = "CPU28"
trigger29  = command = "CPU29"
trigger30  = command = "CPU30"
trigger31  = command = "CPU31"
trigger32  = command = "CPU32"
trigger33  = command = "CPU33"
trigger34  = command = "CPU34"
trigger35  = command = "CPU35"
trigger36  = command = "CPU36"
trigger37  = command = "CPU37"
trigger38  = command = "CPU38"
trigger39  = command = "CPU39"
trigger40  = command = "CPU40"
trigger41  = command = "CPU41"
trigger42  = command = "CPU42"
trigger43  = command = "CPU43"
trigger44  = command = "CPU44"
trigger45  = command = "CPU45"
trigger46  = command = "CPU46"
trigger47  = command = "CPU47"
trigger48  = command = "CPU48"
trigger49  = command = "CPU49"
trigger50  = command = "CPU50"
fvar(0) = 1

;=====================================================================
; Nomal Action
;=====================================================================

;---------------------------------------------------------------------------
;ガード
[state -1, Guard]
type = ChangeState
value = ifelse ((Var(30)=1&&StateType=A),132,Ifelse (StateType != A && (Enemy, HitDefAttr = SA, AA, AT, AP),130,131))
triggerall = fvar(0) && RoundState = 2
triggerall = Var(30)!=1&&StateType!=A || Var(30)=1
triggerall = MoveType = I && enemy,MoveType = A  && P2BodyDist X <= 40 && Ctrl
triggerall = inguarddist
trigger1 = Random <= ifelse ((Var(30)=1&&StateType=A), (500-var(29)*100),(600+var(29)*200)) 

;---------------------------------------------------------------------------
;ジャンプ
[State -1, Jump]
type = ChangeState
value = 40
triggerall = fvar(0) && RoundState = 2
triggerall = !fvar(1)
triggerall= StateType != A && enemy,MoveType = I && Ctrl
triggerall = !inguarddist
trigger1 = BackEdgebodyDist > 5 && P2BodyDist X <= 50 && Random <= (10+(var(3)=1)*10)
trigger2 = Random <= (10+(var(3)=1)*10)
trigger3 = (P2BodyDist X >= 200 && Ctrl) && PrevStateNo = 1000 && Random <= (10+(var(3)=1)*10)

;---------------------------------------------------------------------------
;ラン&ステップ
[State -1, Run]
type = ChangeState
value = IfElse((var(30) = 1 || var(30) = 2 || var(30) = 3),110,100)
triggerall = fvar(0) && RoundState = 2
triggerall = !fvar(1)
triggerall=  StateType != A && Ctrl
triggerall = !inguarddist
trigger1 = enemy,Statetype!=L && P2BodyDist X >= 130 && Random <= (50+(var(3)=[3,5])*50+((var(3)=[1,2])&&Prevstateno=1000)*100)
trigger1 = P2StateType != A && enemy,MoveType !=A

;---------------------------------------------------------------------------
;受身
[State -1]
type = ChangeState
value = 5201
triggerall = fvar(0) && RoundState = 2
triggerall= Var(30) = 2 || Var(30) = 5 || Var(30) = 6
triggerall= Alive && GetHitVar(fall.recover) && random <= 200
trigger1 = PrevStateNo = 5050 && StateNo = 5100
persistent = 0

;=====================================================================
; Super Arts
;=====================================================================

;---------------------------------------------------------------------
; 禁千弐百拾壱式・八稚女（LV.2）
[State -1]
type = ChangeState
value = 3110
triggerall = fvar(0) && RoundState = 2
triggerall = StateType != A
triggerall = (Var(30) != [2,6]) && Power >= 2000 
trigger1 = ((P2BodyDist X = [30,50]) && enemy,MoveType = A && Ctrl && enemy,StateType != A) && Random <= ifelse(power<3000,300,250) && var(29)
trigger2 = ((P2BodyDist X = [30,60]) && enemy,MoveType = A && Ctrl && enemy,StateType = A) && Random <= ifelse(power<3000,250,200) && var(29) && enemy,Vel Y > 0
trigger3 = MoveHit && (Stateno= 230 || Stateno= 720)
trigger4 = var(29) && PrevStateNo = 1301 && Ctrl && enemy,Pos Y > -10

;---------------------------------------------------------------------
; 禁千弐百拾壱式・八稚女（LV.1）
[State -1]
type = ChangeState
value = 3100
triggerall = fvar(0) && RoundState = 2
triggerall = Var(30) != 3 && Var(30) != 6
triggerall = StateType != A
triggerall = (Var(30)!=2&&Var(30)!=4&&Power>=1000)||(Var(30)=4&&(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&(var(22)=[4,5]))||(Var(30)=5&&(Power>=1000||Fvar(8)))
triggerall = P2BodyDist X < 100
trigger1 = MoveHit && (Stateno= 230 || Stateno= 720)
trigger2 = Var(30)=1 && Power>=1000 && StateNo = 3115 && AnimElem = 16,=1 && random <= 700
trigger3 = var(29) && PrevStateNo = 1301 && Ctrl && enemy,Pos Y > -10

;---------------------------------------------------------------------
; 禁千弐百拾壱式・八稚女（LV.3）
[State -1]
type = ChangeState
value = 3120
triggerall = fvar(0) && RoundState = 2
triggerall = StateType != A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= roundstate = 2
triggerall = ((Var(30) != [2,6])&&Power>=3000)||Var(30)=3&&Power>=3000||(Var(30)=4&&(Fvar(8)=1&&(100*life/const(data.life))<30))||(((Var(30)=5&&Power>=1000)||Var(30)=6)&&Fvar(8))
trigger1 = ((P2BodyDist X = [30,55]) && enemy,MoveType = A && Ctrl && enemy,StateType != A) && Random <= 450 && var(29)
trigger2 = ((P2BodyDist X = [30,65]) && enemy,MoveType = A && Ctrl && enemy,StateType = A) && Random <= 350 && var(29) && enemy,Vel Y > 0
trigger3 = MoveHit && (Stateno= 230 || Stateno= 720)
trigger4 = var(29) && PrevStateNo = 1301 && Ctrl && enemy,Pos Y > -10

;---------------------------------------------------------------------
; 裏百式・鬼焔（LV.2）
[State -1]
type = ChangeState
value = 3310
triggerall = fvar(0) && RoundState = 2
triggerall= var(29)
triggerall = StateType != A
triggerall = (Var(30) != [2,6]) && Power >= 2000
triggerall = P2BodyDist X = [0,40]
trigger1 = enemy,MoveType = A && Ctrl && enemy,StateType != A && Random <= ifelse(power<3000,150,200)
trigger2 = enemy,MoveType = A && Ctrl && enemy,StateType = A && Random <= ifelse(power<3000,150,200) && enemy,Vel Y > 0
trigger3 = PrevStateNo = 1301 && Ctrl && Random <= 500

;---------------------------------------------------------------------
; 裏百式・鬼焔（LV.1）
[State -1]
type = ChangeState
value = 3300
triggerall = fvar(0) && RoundState = 2
triggerall= var(29)
triggerall = Var(30) != 3 && Var(30) != 6
triggerall = StateType != A
triggerall = (Var(30)!=2&&Var(30)!=4&&Power>=1000)||(Var(30)=4&&(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&(var(22)=[4,5]))||(Var(30)=5&&(Power>=1000||Fvar(8)))
triggerall = P2BodyDist X < 80
trigger1 = PrevStateNo = 1301 && Ctrl && Random <= 500

;---------------------------------------------------------------------
; 裏百式・鬼焔（LV.3）
[State -1]
type = ChangeState
value = 3320
triggerall = fvar(0) && RoundState = 2
triggerall= var(29)
triggerall = StateType != A
triggerall = ((Var(30) != [2,6])&&Power>=3000)||Var(30)=3&&Power>=3000||(Var(30)=4&&(Fvar(8)=1&&(100*life/const(data.life))<30))||(((Var(30)=5&&Power>=1000)||Var(30)=6)&&Fvar(8))
triggerall = P2BodyDist X = [0,45]
trigger1 = enemy,MoveType = A && Ctrl && enemy,StateType != A && Random <= 450
trigger2 = enemy,MoveType = A && Ctrl && enemy,StateType = A && Random <= 350 && enemy,Vel Y > 0
trigger3 = PrevStateNo = 1301 && Ctrl && Random <= 500

;---------------------------------------------------------------------
; 強パンチ
[State -1]
type = ChangeState
value = IfElse(P2BodyDist X <= 25,225,220)
triggerall = fvar(0) && RoundState = 2
triggerall = P2BodyDist X < 25
triggerall= StateType != A && Ctrl
trigger1 = PrevStateno= 205 && MoveHit && Random <= 120
trigger2 = (P2BodyDist X = [15,22]) && Ctrl && Random <= 400 && enemy,MoveType != H

;---------------------------------------------------------------------
; 弱パンチ
[State -1]
type = ChangeState
value = IfElse(P2BodyDist X <= 10,205,200)
triggerall = fvar(0) && RoundState = 2
triggerall= StateType != A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= (P2BodyDist X = [15,22])
trigger1 =  Ctrl && Random <= 600 && enemy,MoveType != H
trigger2 = ((StateNo = 200 || StateNo = 205 || StateNo = 400 || StateNo = 430) && AnimElem = 3,> 1) && enemy,statetype != A && Random <= 120
trigger3 =  PrevStateNo = 1210 && Ctrl && enemy,MoveType = H && Random = [0,500]

;---------------------------------------------------------------------
; しゃがみ弱キック
[State -1]
type = ChangeState
value = 430
triggerall = fvar(0) && RoundState = 2
triggerall= StateType != A
triggerall= enemy,statetype != L && enemy,stateno != 5120
trigger1 = enemy,MoveType != H && (P2BodyDist X = [5,35]) && !fvar(1) && Ctrl && Random > 450 && enemy,statetype != A
trigger2 = StateNo = 430 && AnimElem = 3,> 1 && enemy,statetype != A && (P2BodyDist X = [0,35]) && Random = [500,800]
trigger3 = enemy,MoveType = H && (P2BodyDist X = [0,25]) && Ctrl && Random > 750 && enemy,statetype != A
trigger4 = PrevStateNo = 1210 && Ctrl && enemy,MoveType = H && Random = [500,800]

;---------------------------------------------------------------------
; 中パンチ
[State -1]
type = ChangeState
value = 210
triggerall = fvar(0) && RoundState = 2
triggerall= StateType != A && Ctrl
trigger1 = PrevStateNo = 1210
trigger1 = Ctrl && P2BodyDist X < 50 && Random = [800,1000]
trigger2 = (P2BodyDist X = [15,22]) && Ctrl && Random <= 400 && enemy,MoveType != H

;---------------------------------------------------------------------
; 弱キック
[State -1]
type = ChangeState
value = IfElse(P2BodyDist X <= 10,235,230)
triggerall = fvar(0) && RoundState = 2
triggerall = P2BodyDist X = [25,60]
triggerall = PrevStateNo = 1210 && Ctrl
trigger1 = MoveHit && StateNo != 1300 && Random <= 150
trigger2 = (P2BodyDist X = [15,22]) && Ctrl && Random <= 300 && enemy,MoveType != H

;---------------------------------------------------------------------
; 百弐拾七式・葵花
;------------------------ 一段目
[State -1]
type = ChangeState
value = 1300
triggerall = fvar(0) && RoundState = 2 && Ctrl
triggerall= StateType != A && StateNo != [1300,1399]
triggerall = P2BodyDist X = [25,80]
triggerall = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger1 = PrevStateNo = 1210
trigger1 = Random <= 250
trigger2 = (P2BodyDist X = [0,50]) && Ctrl && Random <= 300

;------------------------ 二段目
[State -1]
type = ChangeState
value = 1301
triggerall = fvar(0) && RoundState = 2
triggerall= StateType != A
triggerall = P2BodyDist X < 80
triggerall  = StateNo = 1300 && MoveHit && !P2StateType = A
trigger1 = StateNo = 1300 && MoveHit && Random <= 800

;------------------------ 三段目
[State -1]
type = ChangeState
value = 1302
triggerall = fvar(0) && RoundState = 2
triggerall= StateType != A
triggerall = P2BodyDist X < 80
triggerall = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger1 = StateNo = 1301 && MoveHit && Random <= 800

;---------------------------------------------------------------------
; 屑風
[State -1]
type = ChangeState
value = 1200
triggerall= !var(29)
triggerall = fvar(0) && RoundState = 2
triggerall= StateType != A
triggerall= enemy,statetype != L && enemy,stateno != 5120 && enemy,stateno != 40 && enemy,statetype != A
triggerall= p2bodydist X = [0,15]
trigger1 = Random <= 250 && Ctrl
trigger1 = PrevStateNo != 1210

;---------------------------------------------------------------------
; 逆剥ぎ（Ｐ通常投げ）
[State -1]
type = ChangeState
value = 800
triggerall= fvar(0)
triggerall= StateNo != 100 && StateType = S && Ctrl
triggerall= P2MoveType != H && !P2StateType = A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= P2BodyDist X < 25
triggerall= roundstate = 2
trigger1 = Random < 80

;---------------------------------------------------------------------
; 逆剥ぎ（K通常投げ）
[State -1]
type = ChangeState
value = 850
triggerall= fvar(0)
triggerall= StateNo != 100 && StateType = S && Ctrl
triggerall= P2MoveType != H && !P2StateType = A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= P2BodyDist X < 25
triggerall= roundstate = 2
trigger1 = Random = [80,160]

;---------------------------------------------------------------------
; 外式・百合折り（ジャンプ中←＋A）
[State -1]
type = ChangeState
value = 710
triggerall= fvar(0)
triggerall= StateType = A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = P2BodyDist X < 0 && (Random = [0,725]) && time > ifelse(var(15)=4||var(15)=1,8,23) && Ctrl

;---------------------------------------------------------------------
; 外式・夢弾（→＋Y）
[State -1]
type = ChangeState
value = 720
triggerall = fvar(0) && RoundState = 2
triggerall = StateType != A
triggerall = P2BodyDist X < 50
trigger1 = MoveHit && StateNo = 210 && AnimElem = 6,>= 0
trigger1 = Random = [0,400]

;---------------------------------------------------------------------
; ジャンプ強キック
[State -1]
type = ChangeState
value = 650
triggerall = fvar(0)
triggerall = StateNo != 105 && StateType = A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = (P2BodyDist X = [30,70])&& (Random = [551,900]) && time > ifelse(var(15)=4||var(15)=1,8,23) && Ctrl

;---------------------------------------------------------------------
; ジャンプ中パンチ
[State -1]
type = ChangeState
value = 610
triggerall = fvar(0)
triggerall = StateNo != 105 && StateType = A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = (P2BodyDist X = [0,30])&& (Random = [551,900]) && time > ifelse(var(15)=4||var(15)=1,8,23) && Ctrl

;---------------------------------------------------------------------
; 百式・鬼焼き（弱）
[State -1]
type = ChangeState
value = 1100
triggerall = fvar(0)
triggerall= StateType != A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = ((P2BodyDist X = [0,45]) && enemy,MoveType = A && Ctrl) && Random <= (100+var(29)*1050) && enemy,StateType != A
trigger2 = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger2 = var(22)=2 && Random <= 150 && (P2BodyDist X = [15,20])

;---------------------------------------------------------------------
; 百式・鬼焼き（中）
[State -1]
type = ChangeState
value = 1110
triggerall = fvar(0)
triggerall= StateType != A
triggerall= enemy,statetype != L && enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = ((P2BodyDist X = [0,40]) && enemy,MoveType = A && Ctrl) && Random <= (300+var(29)*75) && enemy,StateType != A
trigger2 = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger2 = var(22)=2 && Random <= 150 && (P2BodyDist X = [10,15])

;---------------------------------------------------------------------
; 百式・鬼焼き（強）
[State -1]
type = ChangeState
value = 1120
triggerall = fvar(0)
triggerall = !fvar(1)
triggerall = StateType != A
trigger1 = ((P2BodyDist X = [0,35]) && enemy,MoveType = A && Ctrl) && Random <= (500+var(29)*50) && enemy,StateType != A
trigger2 = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger2 = var(22)=2 && Random <= 150 && (P2BodyDist X = [0,24])

;---------------------------------------------------------------------
; 百八式・闇払い（弱）
[State -1]
type = ChangeState
value = 1000
triggerall= fvar(0) && !fvar(1)
triggerall= !Var(17)
triggerall= StateType != A && roundstate = 2
trigger1 = (P2BodyDist X > 120 && Ctrl) && Random <= 150 && enemy,MoveType != H
trigger2 = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger2 = var(22)=2 && Random > 150 && (P2BodyDist X = [0,60])

;---------------------------------------------------------------------
; 百八式・闇払い（弱）
[State -1]
type = ChangeState
value = 1010
triggerall= fvar(0) && !fvar(1)
triggerall= !Var(17)
triggerall= StateType != A && roundstate = 2
trigger1 = (P2BodyDist X > 120 && Ctrl) && Random <= 200 && enemy,MoveType != H
trigger2 = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger2 = var(22)=2 && Random > 200 && (P2BodyDist X = [0,60])

;---------------------------------------------------------------------
; 百八式・闇払い（強）
[State -1]
type = ChangeState
value = 1020
triggerall= fvar(0) && !fvar(1)
triggerall= !Var(17)
triggerall= StateType != A && roundstate = 2
trigger1 = (P2BodyDist X > 120 && Ctrl) && Random <= 300 && enemy,MoveType != H
trigger2 = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger2 = var(22)=2 && Random > 300 && (P2BodyDist X = [0,60])

;---------------------------------------------------------------------
; 弐百拾弐式・琴月　陰（弱）
[State -1]
type = ChangeState
value = 1400
triggerall = fvar(0)
triggerall= StateType != A
triggerall= enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = ((P2BodyDist X = [120,180]) && Ctrl) && Random <= (40-var(29)*30) && enemy,MoveType != H && enemy,statetype != L
trigger2 = (P2BodyDist X > 180 && Ctrl) && Random <= (100+var(29)*100) && enemy,MoveType != H && enemy,statetype = L 

;---------------------------------------------------------------------
; 弐百拾弐式・琴月　陰（中）
[State -1]
type = ChangeState
value = 1410
triggerall = fvar(0)
triggerall= StateType != A
triggerall= enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = ((P2BodyDist X = [150,200]) && Ctrl) && Random <= (40-var(29)*30) && enemy,MoveType != H && enemy,statetype != L
trigger2 = (P2BodyDist X > 180 && Ctrl) && Random <= (100+var(29)*100) && enemy,MoveType != H && enemy,statetype = L 

;---------------------------------------------------------------------
; 弐百拾弐式・琴月　陰（強）
[State -1]
type = ChangeState
value = 1420
triggerall = fvar(0)
triggerall= StateType != A
triggerall= enemy,stateno != 5120
triggerall= roundstate = 2
trigger1 = (var(29) && (Var(30)!=2&&Var(30)!=4&&Power<1000)||(Var(30)=4&&!(Fvar(8)=1||(100*life/const(data.life))<30))||(Var(30)=2&&!(Power>=1500||Fvar(8)))||(Var(30)=2&&Fvar(8)&&!(var(22)=[4,5]))||(Var(30)=5&&!(Power>=1000||Fvar(8))))||!var(29)
trigger1 = var(22)=2 && Random > 500 && (P2BodyDist X = [0,50])
trigger2 = PrevStateNo = 1000 && Ctrl && P2BodyDist X > 180

;---------------------------------------------------------------------
; Special Attacks , Moves and so on.
;---------------------------------------------------------------------

;---------------------------------------------------------------------
; 回り込み
[State -1]
type = ChangeState
value = 4000
triggerall = fvar(0)
triggerall = var(30)=1 || var(30)=2 || var(30)=5
triggerall= StateType != A
triggerall= roundstate = 2
trigger1 = (P2BodyDist X >= 120 && Ctrl) && Random <= 20
trigger2 = (P2BodyDist X <= 120 && enemy,MoveType != A && enemy,MoveType != H && Ctrl) && Random <= 30
trigger3 = (enemy,MoveType = A && Ctrl) && Random <= 20

;---------------------------------------------------------------------
; 避け
[State -1]
type = ChangeState
value = 4010
triggerall = fvar(0)
triggerall = var(30)=4
triggerall= StateType != A
triggerall= roundstate = 2
trigger1 = (P2BodyDist X >= 120 && Ctrl) && Random <= 20
trigger2 = (P2BodyDist X <= 120 && enemy,MoveType != A && enemy,MoveType != H && Ctrl) && Random <= 30
trigger3 = (enemy,MoveType = A && Ctrl) && Random <= 20

;---------------------------------------------------------------------
; カウンター攻撃
;------------------------パンチ
[State -1]
type = ChangeState
value = 4020
triggerall = fvar(0)
triggerall= StateType != A
triggerall= roundstate = 2
trigger1 = StateNo = 4010 && AnimElem = 3
trigger1 = P2BodyDist X < 35 && enemy,MoveType != A && Random <= 40

;---------------------------------------------------------------------
; パワー溜め動作
[State -1]
type = ChangeState
value = 4100
triggerall = var(30)=4 && fvar(7) <100
triggerall = fvar(0) && RoundState = 2
triggerall=  StateType != A && Ctrl
trigger1 = enemy,Statetype!=L && P2BodyDist X >= 130 && Random <= 40
trigger1 = P2StateType != A && enemy,MoveType !=A

;=====================================================================
; Super Arts
;=====================================================================

;---------------------------------------------------------------------
; 裏百八式・八酒杯（LV.3）
[State -1]
type = ChangeState
value = 3020
triggerall = !fvar(0)
triggerall= !Var(17) && !var(29)
triggerall = Ctrl || StateNo = 40 ||(var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = StateType != A
trigger1 = (Var(30) != [2,6]) && Power >= 3000 && Command = "Ura 108 Shiki: Ya Sakazuki_LV.3"
trigger2 = Var(30) = 3 && Power >= 3000 || (Var(30) = 4 && (Fvar(8) = 1 && (100*life/const(data.life))<30)) || (((Var(30) = 5 && Power >= 1000)||Var(30) = 6) && Fvar(8))
trigger2 = Command = "Ura 108 Shiki: Ya Sakazuki_LV.1" || Command = "Ura 108 Shiki: Ya Sakazuki_LV.2" || Command = "Ura 108 Shiki: Ya Sakazuki_LV.3"

;---------------------------------------------------------------------
; 裏百八式・八酒杯（LV.2）
[State -1]
type = ChangeState
value = 3010
triggerall = !fvar(0)
triggerall= !Var(17) && !var(29)
trigger1 = Ctrl || StateNo = 40 || (var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
trigger1 = (Var(30) != [2,6]) && Power >= 2000 
triggerall = StateType != A
triggerall = Command = "Ura 108 Shiki: Ya Sakazuki_LV.2"  || (Command = "Ura 108 Shiki: Ya Sakazuki_LV.3" && Power < 3000)

;---------------------------------------------------------------------
; 裏百八式・八酒杯（LV.1）
[State -1]
type = ChangeState
value = 3000
triggerall = !fvar(0)
triggerall= !Var(17) && !var(29)
triggerall = Ctrl || StateNo = 40 || (var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = Var(30) != 3 && Var(30) != 6
triggerall = StateType != A
trigger1 = Var(30) != 2 && Var(30) != 4 && Power >= 1000
trigger1 = Command = "Ura 108 Shiki: Ya Sakazuki_LV.1" || ((Command = "Ura 108 Shiki: Ya Sakazuki_LV.2" || Command = "Ura 108 Shiki: Ya Sakazuki_LV.3") && Power < 2000)
trigger2 = (Var(30) = 4 && (Fvar(8) = 1 || (100*life/const(data.life))<30)) || (Var(30) = 2 && (Power >= 1500 || Fvar(8))) || (Var(30) = 2 && Fvar(8) && (var(22)=[4,5])) || (Var(30) = 5 && (Power >= 1000 || Fvar(8)))
trigger2 = Command = "Ura 108 Shiki: Ya Sakazuki_LV.1" || Command = "Ura 108 Shiki: Ya Sakazuki_LV.2" || Command = "Ura 108 Shiki: Ya Sakazuki_LV.2"

;---------------------------------------------------------------------
; 禁千弐百拾壱式・八稚女（LV.3）
[State -1]
type = ChangeState
value = 3120
triggerall = !fvar(0)
triggerall = Ctrl || StateNo = 40 ||(var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = StateType != A
trigger1 = (Var(30) != [2,6]) && Power >= 3000 && Command = "Kin 1211 Shiki: Ya Otome_LV.3"
trigger2 = Var(30) = 3 && Power >= 3000 || (Var(30) = 4 && (Fvar(8) = 1 && (100*life/const(data.life))<30)) || (((Var(30) = 5 && Power >= 1000)||Var(30) = 6) && Fvar(8))
trigger2 = Command = "Kin 1211 Shiki: Ya Otome_LV.1" || Command = "Kin 1211 Shiki: Ya Otome_LV.2" || Command = "Kin 1211 Shiki: Ya Otome_LV.3"

;---------------------------------------------------------------------
; 禁千弐百拾壱式・八稚女（LV.2）
[State -1]
type = ChangeState
value = 3110
triggerall = !fvar(0)
trigger1 = Ctrl || StateNo = 40 || (var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = StateType != A
trigger1 = (Var(30) != [2,6]) && Power >= 2000 
triggerall = Command = "Kin 1211 Shiki: Ya Otome_LV.2"  || (Command = "Kin 1211 Shiki: Ya Otome_LV.3" && Power < 3000)

;---------------------------------------------------------------------
; 禁千弐百拾壱式・八稚女（LV.1）
[State -1]
type = ChangeState
value = 3100
triggerall = !fvar(0)
triggerall = Ctrl || StateNo = 40 || (var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = Var(30) != 3 && Var(30) != 6
triggerall = StateType != A
trigger1 = Var(30) != 2 && Var(30) != 4 && Power >= 1000
trigger1 = Command = "Kin 1211 Shiki: Ya Otome_LV.1" || ((Command = "Kin 1211 Shiki: Ya Otome_LV.2" || Command = "Kin 1211 Shiki: Ya Otome_LV.3") && Power < 2000)
trigger2 = (Var(30) = 4 && (Fvar(8) = 1 || (100*life/const(data.life))<30)) || (Var(30) = 2 && (Power >= 1500 || Fvar(8))) || (Var(30) = 2 && Fvar(8) && (var(22)=[4,5])) || (Var(30) = 5 && (Power >= 1000 || Fvar(8)))
trigger2 = Command = "Kin 1211 Shiki: Ya Otome_LV.1" || Command = "Kin 1211 Shiki: Ya Otome_LV.2" || Command = "Kin 1211 Shiki: Ya Otome_LV.3"

;---------------------------------------------------------------------
; 裏百式・鬼焔（Lv.3）
[State -1]
type = ChangeState
value = 3320
triggerall = !fvar(0)
triggerall= var(29)
triggerall = Ctrl || StateNo = 40 ||(var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = StateType != A
trigger1 = (Var(30) != [2,6]) && Power >= 3000 && Command = "Ura 100 Shiki: Oni homura_LV.3"
trigger2 = Var(30) = 3 && Power >= 3000 || (Var(30) = 4 && (Fvar(8) = 1 && (100*life/const(data.life))<30)) || (((Var(30) = 5 && Power >= 1000)||Var(30) = 6) && Fvar(8))
trigger2 = Command = "Ura 100 Shiki: Oni homura_LV.1" || Command = "Ura 100 Shiki: Oni homura_LV.2" || Command = "Ura 100 Shiki: Oni homura_LV.3"

;---------------------------------------------------------------------
; 裏百式・鬼焔（Lv.2）
[State -1]
type = ChangeState
value = 3310
triggerall = !fvar(0)
triggerall= var(29)
trigger1 = Ctrl || StateNo = 40 || (var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = StateType != A
trigger1 = (Var(30) != [2,6]) && Power >= 2000 
triggerall = Command = "Ura 100 Shiki: Oni homura_LV.2" || (Command = "Ura 100 Shiki: Oni homura_LV.3" && Power < 3000)

;---------------------------------------------------------------------
; 裏百式・鬼焔（Lv.1）
[State -1]
type = ChangeState
value = 3300
triggerall = !fvar(0)
triggerall= var(29)
triggerall = Ctrl || StateNo = 40 || (var(22)=[1,3]) || (Var(30) = 1 && var(22) = -1)
triggerall = Var(30) != 3 && Var(30) != 6
triggerall = StateType != A
trigger1 = Var(30) != 2 && Var(30) != 4 && Power >= 1000
trigger1 = Command = "Ura 100 Shiki: Oni homura_LV.1" || ((Command = "Ura 100 Shiki: Oni homura_LV.2" || Command = "Ura 100 Shiki: Oni homura_LV.3") && Power < 2000)
trigger2 = (Var(30) = 4 && (Fvar(8) = 1 || (100*life/const(data.life))<30)) || (Var(30) = 2 && (Power >= 1500 || Fvar(8))) || (Var(30) = 2 && Fvar(8) && (var(22)=[4,5])) || (Var(30) = 5 && (Power >= 1000 || Fvar(8)))
trigger2 = Command = "Ura 100 Shiki: Oni homura_LV.3" || Command = "Ura 100 Shiki: Oni homura_LV.2" || Command = "Ura 100 Shiki: Oni homura_LV.1"

;=====================================================================
; Special Arts 
;=====================================================================

;---------------------------------------------------------------------
; 屑風
[State -1]
type = ChangeState
value = 1200
triggerall = !fvar(0)
triggerall= Command = "Kuzukaze" && !var(29)
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 弐百拾弐式・琴月　陰（弱）
[State -1]
type = ChangeState
value = 1400
triggerall = !fvar(0)
triggerall= Command = "212 Shiki: Kototsuki In_a"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 弐百拾弐式・琴月　陰（中）
[State -1]
type = ChangeState
value = 1410
triggerall = !fvar(0)
triggerall= Command = "212 Shiki: Kototsuki In_b"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 弐百拾弐式・琴月　陰（強）
[State -1]
type = ChangeState
value = 1420
triggerall = !fvar(0)
triggerall= Command = "212 Shiki: Kototsuki In_c"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 百式・鬼焼き（弱）
[State -1]
type = ChangeState
value = 1100
triggerall= !fvar(0)
triggerall= Command = "100 Shiki: Oniyaki_x"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 百式・鬼焼き（中）
[State -1]
type = ChangeState
value = 1110
triggerall= !fvar(0)
triggerall= Command = "100 Shiki: Oniyaki_y"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 百式・鬼焼き（強）
[State -1]
type = ChangeState
value = 1120
triggerall= !fvar(0)
triggerall= Command = "100 Shiki: Oniyaki_z"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 百八式・闇払い（弱）
[State -1]
type = ChangeState
value = 1000
triggerall= !fvar(0)
triggerall= !Var(17) && Command = "108 Shiki: Yami Barai_x"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 百八式・闇払い（弱）
[State -1]
type = ChangeState
value = 1010
triggerall= !fvar(0)
triggerall= !Var(17) && Command = "108 Shiki: Yami Barai_y"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 百八式・闇払い（強）
[State -1]
type = ChangeState
value = 1020
triggerall= !fvar(0)
triggerall= !Var(17) && Command = "108 Shiki: Yami Barai_z"
triggerall= StateType != A
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;---------------------------------------------------------------------
; 百弐拾七式・葵花
;------------------------ 一段目
[State -1]
type = ChangeState
value = 1300
triggerall = !fvar(0)
triggerall= Command = "127 Shiki: Aoi Hana"
triggerall= StateType != A && StateNo != 1300
trigger1 = Ctrl || (var(22)=[1,2]) || (Var(30) = 1 && var(22) = -1)
trigger2 = Var(30) = 2 && Fvar(8) && (var(22)=[3,5])

;------------------------ 二段目
[State -1]
type = ChangeState
value = 1301
triggerall= !fvar(0)
triggerall= var(19)
triggerall  = StateNo = 1300
trigger1  = AnimElem = 7,>= 0 && AnimElem = 8,< 0
trigger2  = MoveContact

;------------------------ 三段目
[State -1]
type = ChangeState
value = 1302
triggerall= !fvar(0)
triggerall= var(19)
triggerall  = StateNo = 1301
trigger1  = AnimElem = 7,>= 0 && AnimElem = 8,< 0
trigger2  = MoveContact

;------------------------先行入力
[State -1,VarSet(19)]
type = VarSet
var(19) = 1
triggerall= Command = "127 Shiki: Aoi Hana" && !var(19)
trigger1  = StateNo = 1300 && AnimElem = 1,> 1 && AnimElem = 8,< 0
trigger2  = StateNo = 1301 && AnimElem = 1,> 1 && AnimElem = 8,< 0
ignorehitpause = 1

;=====================================================================
; Basic Animation
;=====================================================================

;---------------------------------------------------------------------
;ステップ
[State -1]
type = ChangeState
value = 110
triggerall = !fvar(0)
triggerall = var(30) = 1 || var(30) = 2 || var(30) = 3
trigger1 = Command = "FF" && StateType = S && Ctrl && StateNo != 100

;---------------------------------------------------------------------
;ラン
[State -1]
type = ChangeState
value = 100
triggerall = !fvar(0)
triggerall = var(30) = 0 || var(30) = 4 || var(30) = 5 || var(30) = 6
trigger1 = Command = "FF" && StateType = S && Ctrl && StateNo != 100

;---------------------------------------------------------------------
;RunBack
[State -1]
type = ChangeState
value = 105
triggerall = !fvar(0)
trigger1 = Command = "BB" && StateType = S && Ctrl

;=====================================================================
; 2/3 Buttons
;=====================================================================
;
;=====================================================================
; Basic Throws
;=====================================================================

;---------------------------------------------------------------------
; 逆剥ぎ（Ｐ通常投げ）
[State -1]
type = ChangeState
value = 800
triggerall = !fvar(0)
triggerall = StateNo != 100 && StateType = S && Ctrl = 1
triggerall = P2MoveType != H && !P2StateType = A
trigger1 = Command = "fwd_z" && P2BodyDist X < 25
trigger2 = Command = "back_z" && P2BodyDist X < 20

;---------------------------------------------------------------------
; 逆剥ぎ（Ｋ通常投げ）
[State -1]
type = ChangeState
value = 850
triggerall = !fvar(0)
triggerall = StateNo != 100 && StateType = S && Ctrl = 1
triggerall = P2MoveType != H && !P2StateType = A
trigger1 = Command = "fwd_c" && P2BodyDist X < 25
trigger2 = Command = "back_c" && P2BodyDist X < 20

;---------------------------------------------------------------------
; Special Attacks , Moves and so on.
;---------------------------------------------------------------------

;---------------------------------------------------------------------
; 回り込み
[State -1]
type = ChangeState
value = 4000
triggerall = !fvar(0)
triggerall = Command = "recovery" && (var(30)=1 || var(30)=2 || var(30)=5)
trigger1 = StateType != A && (Ctrl = 1 || StateNo = 100 || StateNo = 101)

;---------------------------------------------------------------------
; 避け
[State -1]
type = ChangeState
value = 4010
triggerall = !fvar(0)
triggerall = Command = "recovery" && var(30)=4
trigger1 = StateType != A && (Ctrl = 1 || StateNo = 100)

;---------------------------------------------------------------------
; カウンター攻撃
;------------------------パンチ
[State -1]
type = ChangeState
value = 4020
triggerall = !fvar(0)
triggerall = Command = "x" || Command = "y" || Command = "z"
trigger1 = StateNo = 4010
trigger1 = AnimElem = 3,>1

;------------------------キック
[State -1]
type = ChangeState
value = 4025
triggerall = !fvar(0)
triggerall = Command = "a" || Command = "b" || Command = "c"
trigger1 = StateNo = 4010
trigger1 = Time = [14,23]

;---------------------------------------------------------------------
; パワー溜め動作
[State -1]
type = ChangeState
value = 4100
triggerall = !fvar(0)
triggerall = command = "charge1" && command = "charge2" && fvar(8)!
triggerall = statetype != A && var(30)=4 && fvar(7) <100
trigger1 = ctrl

;---------------------------------------------------------------------
; パワーMAX発動
[State -1]
type = ChangeState
value = 4150
triggerall = !fvar(0)
triggerall = command = "Pow-MAX"
triggerall = statetype != A && var(30)=5 && Power >= 1000 && fvar(8)!
trigger1 = ctrl

;---------------------------------------------------------------------
; オリコン発動
;------------------- 地上
[State -1]
type = ChangeState
value = 4200
triggerall = !fvar(0)
triggerall = command = "Pow-MAX"
triggerall = statetype != A && var(30)=2 && Power >= 3000 && fvar(8)!
trigger1 = ctrl

;------------------- 空中
[State -1]
type = ChangeState
value = 4210
triggerall = !fvar(0)
triggerall = command = "Pow-MAX"
triggerall = statetype = A && var(30)=2 && Power >= 3000 && fvar(8)!
trigger1 = ctrl

;---------------------------------------------------------------------
; ダウン回避
[State -1]
type = ChangeState
value = 5201
triggerall = !fvar(0)
triggerall = command = "recovery_ground"
triggerall = var(30) = 2 || var(30) = 5 || var(30) = 6
triggerall = alive
triggerall = CanRecover
trigger1 = StateNo = 5100

;---------------------------------------------------------------------
; ガードキャンセル攻撃
[State -1]
type = ChangeState
value = IfElse(Var(29),14500,4500)
triggerall = !fvar(0)
triggerall = Command = "GC_Attack"
triggerall = (StateNo = 150 || StateNo = 152) && StateType != A
triggerall = Var(30) = 1 || Var(30) = 2|| Var(30) = 4 || Var(30) = 5
trigger1 = Var(30) != 2 && Power >= 1000
trigger2 = (Var(30) = 4 && Fvar(8) = 1) || (Var(30) = 2 && Power >= 1500)

;---------------------------------------------------------------------
; ガードキャンセル移動
[State -1]
type = ChangeState
value = IfElse((Command = "GC_back"),4520,4510)
triggerall = !fvar(0)
triggerall = Command = "GC_fwd" || Command = "GC_back"
triggerall = (StateNo = 150 || StateNo = 152) && StateType != A
trigger1 = (Var(30) = 5 && (Fvar(8) = 1 || Power >= 1000)) 

;=====================================================================
; Dir + Button
;=====================================================================

;---------------------------------------------------------------------
; 外式・轟斧　陰　"死神"（→＋B）
[State -1]
type = ChangeState
value = 700
triggerall = !fvar(0)
triggerall= Command = "fwd_b"
trigger1 = StateType != A && (Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[1,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; 外式・百合折り（ジャンプ中←＋A）
[State -1]
type = ChangeState
value = 710
triggerall = !fvar(0)
triggerall= Command = "back_a"
trigger1 = StateType = A && (Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[1,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; 外式・夢弾（→＋Y）
[State -1]
type = ChangeState
value = 720
triggerall = !fvar(0)
triggerall= Command = "fwd_y"
trigger1 = StateType != A && (Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[1,4]) || MoveContact && var(22)=5)))
trigger2 = MoveContact && StateNo = 210 && AnimElem = 6,>= 0

;=====================================================================
; Taunts
;=====================================================================

;---------------------------------------------------------------------
; 挑発
[State -1]
type = ChangeState
value = 195
triggerall = !fvar(0)
triggerall= !var(38)
triggerall= command = "s"
trigger1 = StateType = S && Ctrl = 1

;=====================================================================
; Basic Arts
;=====================================================================

;---------------------------------------------------------------------
; 弱パンチ
[State -1]
type = ChangeState
value = IfElse(P2BodyDist X <= 10,205,200)
triggerall = !fvar(0)
triggerall = Command = "x" && !Command = "holddown"
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))
trigger2  = (StateNo = 200 && AnimElem = 3,> 1)
trigger3  = (StateNo = 205 && AnimElem = 3,> 1)
trigger4  = (StateNo = 400 && AnimElem = 3,> 1)
trigger5  = (StateNo = 430 && AnimElem = 3,> 1)

;---------------------------------------------------------------------
; 中パンチ
[State -1]
type = ChangeState
value = 210
triggerall = !fvar(0)
triggerall = Command = "y" && !Command = "holddown"
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; 強パンチ
[State -1]
type = ChangeState
value = IfElse(P2BodyDist X <= 25,225,220)
triggerall = !fvar(0)
triggerall = Command = "z" && !Command = "holddown"
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; 弱キック
[State -1]
type = ChangeState
value = IfElse(P2BodyDist X <= 10,235,230)
triggerall = !fvar(0)
triggerall = Command = "a" && !Command = "holddown"
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))
trigger2  = (StateNo = 200 && AnimElem = 3,> 1)
trigger3  = (StateNo = 205 && AnimElem = 3,> 1)
trigger4  = (StateNo = 400 && AnimElem = 3,> 1)
trigger5  = (StateNo = 430 && AnimElem = 3,> 1)

;---------------------------------------------------------------------
; 中キック
[State -1]
type = ChangeState
value = 240
triggerall = !fvar(0)
triggerall = Command = "b" && !Command = "holddown"
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; 強キック
[State -1]
type = ChangeState
value = IfElse(P2BodyDist X <= 20,255,250)
triggerall = !fvar(0)
triggerall = Command = "c" && !Command = "holddown"
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; しゃがみ弱パンチ
[State -1]
type = ChangeState
value = 400
triggerall = !fvar(0)
triggerall = Command = "x" && Command = "holddown" && StateType != A
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))
trigger2  = (StateNo = 200 && AnimElem = 3,> 1)
trigger3  = (StateNo = 205 && AnimElem = 3,> 1)
trigger4  = (StateNo = 400 && AnimElem = 3,> 1)
trigger5  = (StateNo = 430 && AnimElem = 3,> 1)

;---------------------------------------------------------------------
; しゃがみ中パンチ
[State -1]
type = ChangeState
value = 410
triggerall = !fvar(0)
triggerall = Command = "y" && Command = "holddown" && StateType != A
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; しゃがみ強パンチ
[State -1]
type = ChangeState
value = 420
triggerall = !fvar(0)
triggerall = Command = "z" && Command = "holddown" && StateType != A
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; しゃがみ弱キック
[State -1]
type = ChangeState
value = 430
triggerall = !fvar(0)
triggerall = Command = "a" && Command = "holddown" && StateType != A
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))
trigger2  = (StateNo = 200 && AnimElem = 3,> 1)
trigger3  = (StateNo = 205 && AnimElem = 3,> 1)
trigger4  = (StateNo = 400 && AnimElem = 3,> 1)
trigger5  = (StateNo = 430 && AnimElem = 3,> 1)

;---------------------------------------------------------------------
; しゃがみ中キック
[State -1]
type = ChangeState
value = 440
triggerall = !fvar(0)
triggerall = Command = "b" && Command = "holddown" && StateType != A
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; しゃがみ強キック
[State -1]
type = ChangeState
value = 450
triggerall = !fvar(0)
triggerall = Command = "c" && Command = "holddown" && StateType != A
trigger1 = StateType != A && (Ctrl || var(22) = 1 || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5)))

;---------------------------------------------------------------------
; ジャンプ弱パンチ
[State -1]
type = ChangeState
value = 600
triggerall = Command = "x" && StateType = A
triggerall = StateNo != 105
trigger1 = Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5))

;---------------------------------------------------------------------
; ジャンプ中パンチ
[State -1]
type = ChangeState
value = 610
triggerall = Command = "y" && StateType = A
triggerall = StateNo != 105
trigger1 = Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5))

;---------------------------------------------------------------------
; ジャンプ強パンチ
[State -1]
type = ChangeState
value = 620
triggerall = Command = "z" && StateType = A
triggerall = StateNo != 105
trigger1 = Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5))

;---------------------------------------------------------------------
; ジャンプ弱キック
[State -1]
type = ChangeState
value = 630
triggerall = Command = "a" && StateType = A
triggerall = StateNo != 105
trigger1 = Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5))

;---------------------------------------------------------------------
; ジャンプ中キック
[State -1]
type = ChangeState
value = 640
triggerall = Command = "b" && StateType = A
triggerall = StateNo != 105
trigger1 = Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5))

;---------------------------------------------------------------------
; ジャンプ強キック
[State -1]
type = ChangeState
value = 650
triggerall = Command = "c" && StateType = A
triggerall = StateNo != 105
trigger1 = Ctrl || (Var(30) = 2 && fvar(8) && ((var(22)=[2,4]) || MoveContact && var(22)=5))

